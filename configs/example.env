# 单一 .env：同时包含非敏感与敏感项（真实值不要提交）
# 建议：cp configs/example.env configs/.env

# === Opencode Server (HTTP) ===
# Worker 通过 opencode server HTTP API 工作；不再每条消息 spawn `opencode run`。
# Docker Compose 默认使用 service 名称；本地直跑可改为 http://localhost:4096
OPENCODE_SERVER_URL=http://opencode-server:4096

# 可选：opencode server Basic Auth（若 server 设置了 OPENCODE_SERVER_PASSWORD，则 worker 也必须配置同一套 username/password）
OPENCODE_SERVER_USERNAME=opencode
OPENCODE_SERVER_PASSWORD=

# 请求超时（毫秒），用于 opencode server 调用
OPENCODE_SERVER_TIMEOUT_MS=600000

# === Opencode 模型模式 ===
# 默认：强制使用 opencode/glm-4.7-free（不需要 API Key）
# 外部模式（litellm/OpenAI-compatible）仅在以下三项都非空时启用：
# - OPENAI_BASE_URL
# - OPENAI_API_KEY
# - OPENCODE_MODELS（逗号分隔 litellm 模型 ID，允许包含 `/`，例如 vol/glm-4.7；内部会拼成 litellm/<id>）
OPENAI_BASE_URL=
OPENAI_API_KEY=
OPENCODE_MODELS=

# 可选：指定 opencode 二进制路径（仅用于本地/旧集成模式；当前 Worker 默认走 opencode server）
OPENCODE_BIN=

# 默认开启 opencode 的 yolo 权限（全工具/全权限 allow）；需要降低权限时可设为 false/0
OPENCODE_YOLO=true

# 平台启用
# 默认开启 QQ；配置 DISCORD_TOKEN 时同时启用 Discord

# LuckyLilliaBot WebUI token（用于登录/生成 Secret；不要留空）
WEBUI_TOKEN=change-me

# llbot Redis 注册表配置
LLBOT_REGISTRY_PREFIX=llbot:registry
LLBOT_REGISTRY_TTL_SEC=30
LLBOT_REGISTRY_REFRESH_SEC=10

# Discord 连接配置（配置 token 即启用）
DISCORD_TOKEN=
DISCORD_APPLICATION_ID=

# 群数据目录
GROUPS_DATA_DIR=/data/groups

# 数据根目录（用于 router/bots 等）
DATA_DIR=/data

# Redis 队列
REDIS_URL=redis://redis:6379

# BullMQ key 前缀（可选；producer/consumer 必须一致）
BULLMQ_PREFIX=

# Bot ID 映射（可选，格式 alias:canonical，用逗号分隔）
BOT_ID_ALIASES=

# 对话记忆：由 Opencode session 负责（持续复用 `ses_...`）

# PostgreSQL（历史与可变状态）
POSTGRES_PASSWORD=
DATABASE_URL=postgres://postgres:postgres@postgres:5432/opencode

# HTTP 端口（Adapter）
HTTP_PORT=8080

# HTTP 端口（Worker；0 表示随机端口）
WORKER_HTTP_PORT=8081

# 强制群聊 groupId 覆盖（高级选项：会让多个群共享同一套群配置/会话目录；私聊始终 groupId=0；未设置则使用消息 guildId）
# FORCE_GROUP_ID=1

# 可选：/health 版本号（默认读取 npm_package_version）
APP_VERSION=

# 日志配置
LOG_LEVEL=info
LOG_FORMAT=json

# 飞书 Webhook 日志（可选；用于把对话链路的 telemetry/span 推送到飞书群）
FEISHU_LOG_ENABLED=false
FEISHU_WEBHOOK_URL=
FEISHU_LOG_MAX_BYTES=4000
FEISHU_LOG_QUEUE_SIZE=2000
FEISHU_LOG_MIN_INTERVAL_MS=200
FEISHU_LOG_TIMEOUT_MS=5000

# SSRF 防护（默认启用拦截私网/loopback/link-local/metadata；allowlist 预留但默认不启用）
SSRF_MAX_REDIRECTS=3
SSRF_ALLOWLIST_ENABLED=false
SSRF_ALLOWLIST_HOSTS=

# MCP 配置
MCP_TALESOFAI_URL=https://mcp.talesofai.cn/mcp

# TalesOfAI 登录 token（用于 MCP 请求头 x-token；也可通过 /login 写入会话）
NIETA_TOKEN=

# 可选：HTTP 管理端点鉴权 token（未设置则禁用管理接口）
API_TOKEN=
