# 0.0.29 Vision: 配置语义收敛与可测试性

> 注：这是愿景文档，用来约束方向与取舍；不是“把想法全塞进来”的许愿池。

## 核心判断

值得做：当前配置项里有“名字像默认值，行为却是强制覆盖”的坑；再加上测试环境读取本地 `.env` 这种隐式依赖，都会让系统变得不可预测。

## 目标

- 配置语义一眼能懂：默认行为不需要读源码。
- 示例配置只放“常用且安全”的项；高风险开关默认注释并明确后果。
- 测试可复现：不依赖本机 `configs/.env`、不触碰用户目录（`~/.config`/`~/.local`）。

## 非目标

- 不做向后兼容（坏名字就该死）。
- 不引入新的“策略枚举”来掩盖旧设计问题。

## 关键方向

- **命名收敛**：覆盖类配置统一使用 `FORCE_*`/`OVERRIDE_*` 前缀；默认值就叫 `DEFAULT_*`，不要混用。
- **配置收敛**：空字符串等同“未设置”，避免 `""` 触发类型强制转换引入假值。
- **测试隔离**：测试环境禁止隐式加载 `configs/.env`；需要外部模式时显式设置 `HOME` 到临时目录。

## 验证标准

- `bun run check` 全绿。
- 文档对配置行为的描述能直接映射到代码路径（不允许“注释说 A，代码做 B”）。
